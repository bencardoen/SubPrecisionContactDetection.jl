<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parameter selection and tuning · SubPrecisionContactDetection Documentation</title><meta name="title" content="Parameter selection and tuning · SubPrecisionContactDetection Documentation"/><meta property="og:title" content="Parameter selection and tuning · SubPrecisionContactDetection Documentation"/><meta property="twitter:title" content="Parameter selection and tuning · SubPrecisionContactDetection Documentation"/><meta name="description" content="Documentation for SubPrecisionContactDetection Documentation."/><meta property="og:description" content="Documentation for SubPrecisionContactDetection Documentation."/><meta property="twitter:description" content="Documentation for SubPrecisionContactDetection Documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../tutorial/"><img src="../assets/logo.png" alt="SubPrecisionContactDetection Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../tutorial/">SubPrecisionContactDetection Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li class="is-active"><a class="tocitem" href>Parameter selection and tuning</a><ul class="internal"><li><a class="tocitem" href="#Checking-default-values"><span>Checking default values</span></a></li><li><a class="tocitem" href="#Key-parameters"><span>Key parameters</span></a></li><li><a class="tocitem" href="#Parameter-selection-advice"><span>Parameter selection advice</span></a></li></ul></li><li><a class="tocitem" href="../output/">Generated output</a></li><li><a class="tocitem" href="../clustercomputing/">Cluster Usage</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../faq/">Help and FAQ</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Parameter selection and tuning</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Parameter selection and tuning</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bencardoen/SubPrecisionContactDetection.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/bencardoen/SubPrecisionContactDetection.jl/blob/main/docs/src/parameters.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Parameter-selection-and-tuning."><a class="docs-heading-anchor" href="#Parameter-selection-and-tuning.">Parameter selection and tuning.</a><a id="Parameter-selection-and-tuning.-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-selection-and-tuning." title="Permalink"></a></h1><p>This section describes the usage of parameters for the scripts and the algorithm.</p><ul><li><a href="#Parameter-selection-and-tuning.">Parameter selection and tuning.</a></li><li class="no-marker"><ul><li><a href="#Checking-default-values">Checking default values</a></li><li><a href="#Key-parameters">Key parameters</a></li><li><a href="#Parameter-selection-advice">Parameter selection advice</a></li><li class="no-marker"><ul><li><a href="#2D-or-3D">2D or 3D</a></li><li class="no-marker"><ul><li class="no-marker"><ul><li><a href="#Concept">Concept</a></li></ul></li><li><a href="#Guidance">Guidance</a></li></ul></li><li><a href="#Z-filter-(background-removal)">Z-filter (background removal)</a></li><li class="no-marker"><ul><li><a href="#Concept-2">Concept</a></li><li><a href="#Guidance-2">Guidance</a></li></ul></li><li><a href="#Window-size-(w)">Window size (w)</a></li><li class="no-marker"><ul><li><a href="#Concept-3">Concept</a></li><li><a href="#Guidance-3">Guidance</a></li></ul></li><li><a href="#Alpha-and-Beta,-or-confidence,-significance,-and-power.">Alpha and Beta, or confidence, significance, and power.</a></li><li class="no-marker"><ul><li><a href="#Concept-4">Concept</a></li><li><a href="#Guidance-4">Guidance</a></li></ul></li><li><a href="#Vesicle-filtering">Vesicle filtering</a></li><li class="no-marker"><ul><li><a href="#Concept-5">Concept</a></li><li><a href="#Guidance-5">Guidance</a></li></ul></li><li><a href="#Sampling">Sampling</a></li><li class="no-marker"><ul><li><a href="#Concept-6">Concept</a></li><li><a href="#Guidance-6">Guidance</a></li></ul></li></ul></li></ul></li></ul><h2 id="Checking-default-values"><a class="docs-heading-anchor" href="#Checking-default-values">Checking default values</a><a id="Checking-default-values-1"></a><a class="docs-heading-anchor-permalink" href="#Checking-default-values" title="Permalink"></a></h2><p>You can easily check the default values and the parameter names by querying the code.</p><pre><code class="language-julia hljs">params = get_defaults()
for k in keys(params)
    @info &quot;$k ==&gt; $(params[k])&quot;
end</code></pre><p>This would give:</p><pre><code class="language-julia hljs">[ Info: lpsigmas → 1-1-1
[ Info: inregex → *[1,2].tif
[ Info: minzslice → 1
[ Info: mode → non-decon
[ Info: zscore → 3
[ Info: outpath → 
[ Info: radius → false
[ Info: sphericity → 1.0
[ Info: volumethreshold → 0
[ Info: cube-vesicle-intensity-mean → 0.2
[ Info: nooutput → false
[ Info: normalize → false
[ Info: alpha → 0.05
[ Info: prc → 1.0
[ Info: cube-vesicle-sample-size → 5
[ Info: denominator → 1.0
[ Info: dimension → 3
[ Info: weighted → false
[ Info: beta → 0.05
[ Info: volumethresholdchannel → 1
[ Info: noutput → false
[ Info: save-numerical-data → false
[ Info: windowsize → 1
[ Info: skipstats → false
[ Info: sigmas → 1-1-1
[ Info: inpath → 
[ Info: filtermode → arithmetic
[ Info: cube-vesicle-size-ln → 9
[ Info: dry-run → false
[ Info: deconvolved → true</code></pre><h2 id="Key-parameters"><a class="docs-heading-anchor" href="#Key-parameters">Key parameters</a><a id="Key-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Key-parameters" title="Permalink"></a></h2><p>Critical ones are :</p><ul><li>inpath: Directory with your data</li><li>outpath: Where output should be written</li><li>inregex: &quot;*[1,2].tif&quot; Looks for files ending with 1 or 2 (extension tif). If you want to use 4 channels out of 8, and only odd ones, you could write &quot;*[0,2,4,6].tif&quot;. The pipeline will automatically combine them for you. <span>$\frac{4!}{(2)!}=6$</span> combinations would be generated, in order, e.g. &quot;0–2&quot;, &quot;0–4&quot;, etc.</li><li>dimension : 2D or 3D.</li><li>mode : non-decon, decon, or both. Do not use non-deconvolved data, stick to &#39;decon&#39;</li><li>alpha/beta: Significance and power used in probabilistic filtering</li><li>windowsize: w in k-D means a window of <span>$(1 + 2 \times w)^k$</span> voxels. </li><li>zscore: see below</li></ul><h2 id="Parameter-selection-advice"><a class="docs-heading-anchor" href="#Parameter-selection-advice">Parameter selection advice</a><a id="Parameter-selection-advice-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-selection-advice" title="Permalink"></a></h2><p>MCS-Detect has multiple parameters that will determine the precision and recall of the predicted contacts.  While a full discussion is available in the paper, here we will give a brief explanation and guidance as to how to set them.</p><h3 id="2D-or-3D"><a class="docs-heading-anchor" href="#2D-or-3D">2D or 3D</a><a id="2D-or-3D-1"></a><a class="docs-heading-anchor-permalink" href="#2D-or-3D" title="Permalink"></a></h3><h5 id="Concept"><a class="docs-heading-anchor" href="#Concept">Concept</a><a id="Concept-1"></a><a class="docs-heading-anchor-permalink" href="#Concept" title="Permalink"></a></h5><p>The differential correlation can work in 2 or 3 dimensions. If you have 3D data, run it in 3D mode, otherwise you lose the z-dimensional information. However, if you have 2D, realise that the windowsize is now a factor smaller. w=1 gives you 3x3x3 in 3D, 3x3 in 2D. This affect the statistical power and confidence. </p><h4 id="Guidance"><a class="docs-heading-anchor" href="#Guidance">Guidance</a><a id="Guidance-1"></a><a class="docs-heading-anchor-permalink" href="#Guidance" title="Permalink"></a></h4><ul><li>3D data in 3D mode</li><li>2D data: increase window size (see below) or lower alpha/beta values</li></ul><h3 id="Z-filter-(background-removal)"><a class="docs-heading-anchor" href="#Z-filter-(background-removal)">Z-filter (background removal)</a><a id="Z-filter-(background-removal)-1"></a><a class="docs-heading-anchor-permalink" href="#Z-filter-(background-removal)" title="Permalink"></a></h3><h4 id="Concept-2"><a class="docs-heading-anchor" href="#Concept-2">Concept</a><a class="docs-heading-anchor-permalink" href="#Concept-2" title="Permalink"></a></h4><p>Because 3D STED has anisotropic resolution in Z (worse in Z than in X/Y), it is possible to see intensity <code>bleedthrough</code> or <code>shadowing</code> across Z.  For example, say you have a mitochondrial vesicle at Z-slice 5.  Bleedthrough can lead to intensity mimicking a faint object at Z-slice 8. The Z-filter removes this by filtering the intensity distribution, per channel. If you set Z=1, all intensity <strong>below</strong> <span>$\mu + 1 * \sigma$</span> is set to zero.</p><h4 id="Guidance-2"><a class="docs-heading-anchor" href="#Guidance-2">Guidance</a><a class="docs-heading-anchor-permalink" href="#Guidance-2" title="Permalink"></a></h4><p>A z-value is that is too high will cause false negatives because you&#39;re removing intensity from the organelles, not the background. A too low value will included possible contacts between organelles and phantom intensity, e.g. false positives. A value of z=3 is used for the paper, derived from the size of the cell and the anisotropy.  Recommended usage is to test Z-values on a single representative cell, and plot the organelle volume, in combination with visual inspection.  Instructions on how to do this and accompanying scripts can be found <a href="https://github.com/NanoscopyAI/tutorial_mcs_detect?tab=readme-ov-file#mcs-detect-background-filtering-only--segmentation">here</a>.</p><h3 id="Window-size-(w)"><a class="docs-heading-anchor" href="#Window-size-(w)">Window size (w)</a><a id="Window-size-(w)-1"></a><a class="docs-heading-anchor-permalink" href="#Window-size-(w)" title="Permalink"></a></h3><h4 id="Concept-3"><a class="docs-heading-anchor" href="#Concept-3">Concept</a><a class="docs-heading-anchor-permalink" href="#Concept-3" title="Permalink"></a></h4><p>Correlation requires a comparison between two vectors of data, in 2- or 3D images this means a window size.  If you set w=2 the window will be (2*2+1)^D for D dimensions. So 5x5 in 2D, 5x5x5 in 3D. w=1 would be 3x3, or 3x3x3 and so forth.</p><h4 id="Guidance-3"><a class="docs-heading-anchor" href="#Guidance-3">Guidance</a><a class="docs-heading-anchor-permalink" href="#Guidance-3" title="Permalink"></a></h4><p>A too large value will consume more memory, and will miss finer patterns.  A too small value will fail to capture large patterns.  So what, then is &#39;too&#39; small or large? At a minimum, the window should cover the width of the contact, but no more than 2.5x.  The interested reader will detect similarities with how resolution and pixel-dimensions relate. I will give an example to give a more actionable insight: Let us assume pixel precision is 50nm in X, Y, and 75nm in Z. Say the expected contacts you wish to capture are 0-25nm.  In this case w=1 would be sufficient, because a window of 3x3x3 would span 150nm lateral, and 225nm axial.  W=2 would mean 250nm lateral and 375nm axial, which is likely too large, it would be dominated by differentials that are unrelated to the contact. <strong>Important</strong> The window size determines the statistical power of the correlation. A 3x3 window in 2D has limited statistical power. See below.</p><h3 id="Alpha-and-Beta,-or-confidence,-significance,-and-power."><a class="docs-heading-anchor" href="#Alpha-and-Beta,-or-confidence,-significance,-and-power.">Alpha and Beta, or confidence, significance, and power.</a><a id="Alpha-and-Beta,-or-confidence,-significance,-and-power.-1"></a><a class="docs-heading-anchor-permalink" href="#Alpha-and-Beta,-or-confidence,-significance,-and-power." title="Permalink"></a></h3><h4 id="Concept-4"><a class="docs-heading-anchor" href="#Concept-4">Concept</a><a class="docs-heading-anchor-permalink" href="#Concept-4" title="Permalink"></a></h4><p>A correlation is a statistical estimator, and comes with a confidence value (&#39;p-value&#39;).  Alpha control what acceptable levels of confidence are allowed, whereas beta controls statistical power.  A recap from statistics:</p><ul><li>Significance (alpha): The probability that an observed difference is not due to random effects</li><li>Power (beta): The probability that you can observe a given difference (of a given magnitude)</li></ul><p>What does this mean in practice? We can compute what is <strong>minimal</strong> observable correlation you can detect, given alpha and beta. First, the 2D case (so 3x3, 5x5, ...)</p><p><img src="../assets/minr2d.png" alt="minr2d.png"/></p><p>Next, 3D:</p><p><img src="../assets/minr3d.png" alt="minr3d.png"/></p><p>Trouble reading these plots? Let&#39;s say you use a 3x3x3 window (w=1, in 3D).  If you set alpha=beta=0.05 (95% confidence and power), then the smallest possible observable correlation is <strong>0.665</strong>. (In the 2nd plot, X=27, Y=0.665).</p><p>Suppose you increase the window to w=2, 3D, then you have <strong>0.341</strong> (X=125, Y=0.341).</p><p>If you want to have the same minimum correlation in 3D with a window of 27, you would need to change your alpha and beta to <strong>0.35</strong></p><p>We can also plot this </p><p><img src="../assets/minrkd.png" alt="minrkd.png"/></p><p>The functions to compute this are available for you as well:</p><pre><code class="language-julia hljs"># w=2, 2D
minr = compute_min_r_for_sample_corr(25, 0.05, 0.05)</code></pre><p>and</p><pre><code class="language-julia hljs"># r=0.2, 2D
window = compute_sample_size_for_min_corr(0.2, 0.05, 0.05)</code></pre><h4 id="Guidance-4"><a class="docs-heading-anchor" href="#Guidance-4">Guidance</a><a class="docs-heading-anchor-permalink" href="#Guidance-4" title="Permalink"></a></h4><ul><li>If you keep the window the same, and go to 2D, set alpha and beta from to have the same recall.</li><li>If precision is too low, reduce alpha and beta (e.g. 0.05 to 0.1, or 0.25).</li><li>If recall is too high (artifacts), increase alpha and beta (0.05 to 0.01 or 0.001)</li></ul><h3 id="Vesicle-filtering"><a class="docs-heading-anchor" href="#Vesicle-filtering">Vesicle filtering</a><a id="Vesicle-filtering-1"></a><a class="docs-heading-anchor-permalink" href="#Vesicle-filtering" title="Permalink"></a></h3><h4 id="Concept-5"><a class="docs-heading-anchor" href="#Concept-5">Concept</a><a class="docs-heading-anchor-permalink" href="#Concept-5" title="Permalink"></a></h4><p>The postprocessing scripts use size (logarithm) and mean intensity of vesicles to filter them out.  This can only be empirically estimated. </p><h4 id="Guidance-5"><a class="docs-heading-anchor" href="#Guidance-5">Guidance</a><a class="docs-heading-anchor-permalink" href="#Guidance-5" title="Permalink"></a></h4><p>Plot the intensity and object sizes of the mitochondria channel, and look for a separation between large and bright objects, versus small and faint. Off the shelf clustering methods can be of help. Alternatively, segment the image before processing.  <strong>NOTE</strong> Contact detection does not differentiate between mitochondria and vesicles, the interaction may be functionally different, but the contacts are no less real.</p><h3 id="Sampling"><a class="docs-heading-anchor" href="#Sampling">Sampling</a><a id="Sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling" title="Permalink"></a></h3><h4 id="Concept-6"><a class="docs-heading-anchor" href="#Concept-6">Concept</a><a class="docs-heading-anchor-permalink" href="#Concept-6" title="Permalink"></a></h4><p>Because contacts are large and infrequent, or small and frequent, the statistical analysis can be unstable.  More precisely, the distribution is long tailed containing extreme values, and those extreme values are often the ones of interest (e.g. ribomerc). To offset this, the coverage computation and local density (nr of contacts/window) uses a window, defaulting to 5x5x5 (which corresponds to w=2). </p><h4 id="Guidance-6"><a class="docs-heading-anchor" href="#Guidance-6">Guidance</a><a class="docs-heading-anchor-permalink" href="#Guidance-6" title="Permalink"></a></h4><p>The smaller you set this, the more you split objects apart.  Ideally you set this window to be no smaller than the largest expected object. Sampling windows do not overlap, and mitochondria that are only partially visible in a window (few voxels), are discarded.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« Tutorial</a><a class="docs-footer-nextpage" href="../output/">Generated output »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 28 October 2024 23:43">Monday 28 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
